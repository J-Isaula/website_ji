---
title: "Predicción de primas de seguros médicos con Machine Learning"
subtitle: "Utilizando Python"
author: "Juan Isaula"
date: "2023-11-19"
categories: [Python, Seguros, Random Forest Regressor]
image: "seguros.jpeg"
---

Una persona que ha contratado una póliza de seguro médico obtiene cobertura de seguro médico pagando una prima determinada. Existen muchos factores que determinan la prima del seguro médico. Entonces, si deseas saber como podemos utilizar `Machine Learning` para predecir la prima del seguro médico, este artículo es para ti. En este artículo, lo guiaré a traves de la tarea de predicción de primas de seguros médicos con Machine Learning usando `Python`.

## Predicción de primas de seguro médico

El monto de la prima de una póliza de seguro médico depende de persona a persona, ya que muchos factores afectan el monto de la prima de una póliza de seguro médico. Por ejemplo, la edad, una personas joven tiene menos probabilidad de tener problemas de salud importantes en comparación con una persona mayor. Por tanto, tratar a una persona mayor será caro en comparación con una joven. Por este motivo, una persona mayor debe pagar una prima más elevada que una persona joven.

Además de la edad, muchos otros factores afectan la prima de una póliza de seguro médico. A este punto, espero haya comprendido qué es el seguro médico y cómo se determina la prima de una poliza de seguro médico. En la siguiente sección, lo guiaré a través de la tarea de predicción de primas de seguros médicos con aprendizaje automático utilizando Python.

## Predicción de primas de seguros médicos usando Python

El conjunto de datos que estoy utilizando para la tarea de predicción de primas de seguros médicos se recopila de [Kaggle](https://www.kaggle.com/datasets/selahattinsanli/health-insurance/). Contiene datos sobre:

1.  `age:` la edad de la persona.
2.  `sex:` género de la persona.
3.  `bmi:` índice de masa corporal de la persona.
4.  `children:` cuantos hijos va a tener la persona.
5.  `smoker:` si la persona fuma o no.
6.  `region:` la región donde vive la persona.
7.   `charges:` cargos de la prima de segura.

Entonces, importemos el conjunto de datos y las bibliotecas de Python necesarias para esta tarea:

```{python}
import numpy as np
import pandas as pd
data = pd.read_csv("health_insurance_charges.csv")
data.head()
```

Antes de continuar, echemos un vistazo a si este conjunto de datos contiene valores nulos o no:

```{python}
data.isnull().sum()
```

Por lo tanto, el conjunto de datos está listo para ser utilizado. Después de tener las primeras impresiones de estos datos, me fijé en la columna ***smoker,*** que indica si la persona fuma o no. Esta es una característica importante de este conjunto de datos porque una persona que fuma tiene más probabilidades de tener problemas de salud importantes en comparación con una persona que no fuma. Así que veamos la distribución de personas que fuman y que no:

```{python}
import plotly.express as px
data = data
figure = px.histogram(data, x = "sex", color = "smoker", title= "Number of Smokers")
figure.show()
```

Según la visualización anterior, 1,144 hombres y 980 mujeres no fuman y 243 hombres y 133 mujeres fuman. Es importante utilizar esta función al entrenar un modelo de Machine Learning, por lo que ahora reemplazaré los valores de las columnas ***sex*** y ***smoker*** con 0 y 1, ya que ambas columnas contienen valores de cadena:

```{python}
data["sex"] = data["sex"].map({"female": 0, "male": 1})
data["smoker"] = data["smoker"].map({"no": 0, "yes": 1})
print(data.head())
```

Ahora echemos un vistazo a la distribución de las regiones donde vive la gente según el conjunto de datos:

```{python}
import plotly.express as px
pie = data["region"].value_counts()
regions = pie.index
population = pie.values
fig = px.pie(data, values=population, names=regions)
fig.show()
```

Ahora echemos un vistazo a la correlación entre las características de este conjunto de datos:

```{python}
print(data.corr())
```

## Modelo de predicción de primas de seguro médico

Pasemos ahora a entrenar un modelo de aprendizaje automático para la tarea de predecir las primas de seguros médicos. Primero, dividiré los datos en conjuntos de entrenamiento y prueba:

```{python}
x = np.array(data[["age", "sex", "bmi", "smoker"]])
y = np.array(data["charges"])

from sklearn.model_selection import train_test_split
xtrain, xtest, ytrain, ytest = train_test_split(x, y, test_size=0.2, random_state=42)
```

Después de usar diferentes algoritmos de Machine Learning, encontré que el algoritmo de `Random Forest` es el de mejor rendimiento para esta tarea. Entonces aquí entrenaré el modelo usando el algoritmo de `Random Forest Regression`:

```{python}
from sklearn.ensemble import RandomForestRegressor
forest = RandomForestRegressor()
forest.fit(xtrain, ytrain)
```

Ahora echemos un vistazo a los valores predichos del modelo:

```{python}
ypred = forest.predict(xtest)
data = pd.DataFrame(data={"Monto de prima predicho": ypred})
print(data.head())
```

Así es como se puede entrenar un modelo de Machine Learning para la tarea de predicción de primas de seguros médicos utilizando `Python`.

## Resumen 

El monto de la prima de una póliza de seguro médico depende de persona a persona, ya que muchos factores afectan el monto de la prima de una póliza de seguro médico. Espero que te haya gustado este artículo sobre predicción de primas de seguros médicos con Machine Learning utilizando Python. No dude en hacer sus valiosas preguntas en la sección de comentarios a continuación.
